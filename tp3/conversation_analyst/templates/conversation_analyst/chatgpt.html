{% extends "conversation_analyst/base.html" %}
{% block title %}

{% endblock %}
<title>ChatGPT Analysis</title>
{% block body %}
{% load static %}
<script type="text/javascript" src="{% static 'js/chatgptmessage.js' %}"></script>
<script type="text/javascript" src="{% static 'js/searchchats.js' %}"></script>
<link rel="stylesheet" href="{% static 'css/chatGPT.css' %}">

<div class="gpt-body container-fluid">
  <div class="row">

    <section class="side-past-charts col-md-2">
      <h3 class="mt-3">Past Chats</h3>
      <div class="input-group mb-3">
        <input type="text" class="form-control" id="search-input" placeholder="Search">
        <button class="btn btn-secondary search-chats" type="button"> <span><i class="bi bi-search"></i></span></button>
      </div>
      {% include "conversation_analyst/chats.html" %}
    </section>

    <section class="main col-md-7">
      <div class="scroll-container chat-container mt-3" id="scroll">
        {% include "conversation_analyst/chatgpt_messages.html" %}
        <br>
        <h3 id="loading_message"></h3>
        {% if messages %}
        <div class="row justify-content-center" id="#row" style="height: 10rem;">
          <div class="col-12">
            <div class="input-group mb-3">
              <input type="text" class="form-control" id="message_content" placeholder="Type your message">
              <button class="btn btn-secondary chatgpt_new_message" type="button"><span><i
                    class="bi bi-send"></i></span></button>
            </div>
          </div>
        </div>
        {% endif%}
      </div>
    </section>
    {% include "conversation_analyst/prompts.html" %}
  </div>
</div>

<style>
  .scroll-container {
    max-height: 100vh;
    overflow-y: auto;
  }
</style>

<script>
  $(document).ready(function () {
    var sectionElement = document.getElementById('scroll');
    var inputElement = document.getElementById('message_content');


    setTimeout(function () {
      focusOnInputElement(sectionElement, inputElement);
    }, 0);

    function focusOnInputElement(sectionElement, inputElement) {
      var inputTopOffset = inputElement.parentElement.offsetTop;
      sectionElement.scrollTop = inputTopOffset;
    }
  });

</script>
{% endblock %}